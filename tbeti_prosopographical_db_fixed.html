<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ṭbetis sulta maṭiane - Prosopographical Database</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', serif;
            line-height: 1.5;
            color: #000;
            background: #fff;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            border-bottom: 1px solid #ccc;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 24px;
            font-weight: normal;
            margin-bottom: 8px;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            font-size: 16px;
            font-style: italic;
            margin-bottom: 15px;
        }

        .manuscript-info {
            font-size: 12px;
            text-align: center;
            color: #666;
            border: 1px solid #ddd;
            padding: 10px;
        }

        .search-controls {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
        }

        .search-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }

        input, select {
            padding: 6px 8px;
            border: 1px solid #999;
            font-family: inherit;
            font-size: 13px;
        }

        input:focus, select:focus {
            outline: 1px solid #000;
            border-color: #000;
        }

        button {
            background: #fff;
            border: 1px solid #999;
            padding: 6px 12px;
            cursor: pointer;
            font-family: inherit;
            font-size: 13px;
        }

        button:hover {
            background: #f5f5f5;
        }

        button:active {
            background: #eee;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            border: 1px solid #ddd;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .results {
            border: 1px solid #ddd;
        }

        .results-header {
            background: #f8f8f8;
            border-bottom: 1px solid #ddd;
            padding: 10px 15px;
            font-weight: bold;
            font-size: 13px;
        }

        .person-card {
            border-bottom: 1px solid #eee;
            padding: 15px;
        }

        .person-card:last-child {
            border-bottom: none;
        }

        .person-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .person-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .detail-item {
            display: flex;
        }

        .detail-label {
            font-weight: bold;
            margin-right: 8px;
            min-width: 60px;
        }

        .family-members {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #eee;
            background: #fafafa;
        }

        .family-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .family-member {
            display: inline-block;
            margin: 2px 8px 2px 0;
            font-size: 12px;
            border: 1px solid #ddd;
            padding: 2px 6px;
            background: #fff;
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            font-style: italic;
            color: #666;
        }

        .georgian-text {
            font-family: 'DejaVu Sans', 'Arial Unicode MS', sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
            vertical-align: top;
        }

        th {
            background: #f8f8f8;
            font-weight: bold;
            font-size: 12px;
        }

        td {
            font-size: 13px;
        }

        .view-toggle {
            margin-bottom: 15px;
        }

        .view-toggle button {
            margin-right: 5px;
        }

        .view-toggle button.active {
            background: #000;
            color: #fff;
        }

        @media (max-width: 768px) {
            .search-row {
                grid-template-columns: 1fr;
            }

            .person-details {
                grid-template-columns: 1fr;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div style="text-align: right; margin-bottom: 15px;">
                <button onclick="toggleLanguage()" id="langToggle">ქართული</button>
            </div>
            <h1 id="mainTitle">Ṭbetis sulta maṭiane</h1>
            <div class="subtitle" id="subtitle">Synodal Records from Ṭbeti - Prosopographical Database</div>
            <div class="manuscript-info">
                <strong id="msLabel">Manuscript:</strong> St. Petersburg, Russian National Library, P10/P13 |
                <strong id="periodLabel">Period:</strong> <span id="periodText">Medieval</span> |
                <strong id="languageLabel">Language:</strong> <span id="languageText">Old Georgian</span> |
                <strong id="scriptLabel">Script:</strong> Nuskhuri
            </div>
        </header>

        <div class="search-controls">
            <div class="search-row">
                <input type="text" id="nameSearch" placeholder="Name">
                <input type="text" id="surnameSearch" placeholder="Surname">
                <select id="typeFilter">
                    <option value="" id="allTypesOption">All types</option>
                    <option value="main" id="mainOption">Main person</option>
                    <option value="wife" id="wifeOption">Wife</option>
                    <option value="son" id="sonOption">Son</option>
                    <option value="daughter" id="daughterOption">Daughter</option>
                    <option value="brother" id="brotherOption">Brother</option>
                    <option value="sister" id="sisterOption">Sister</option>
                    <option value="mother" id="motherOption">Mother</option>
                    <option value="father" id="fatherOption">Father</option>
                </select>
                <input type="text" id="placeSearch" placeholder="Place">
            </div>
            <div class="search-row">
                <button onclick="performSearch()" id="searchBtn">Search</button>
                <button onclick="clearSearch()" id="clearBtn">Clear</button>
                <button onclick="showAll()" id="showAllBtn">Show All</button>
                <button onclick="exportData()" id="exportBtn">Export CSV</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <span class="stat-number" id="totalEntries">0</span>
                <span class="stat-label" id="entriesLabel">Entries</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="totalPersons">0</span>
                <span class="stat-label" id="personsLabel">Persons</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="uniqueSurnames">0</span>
                <span class="stat-label" id="surnamesLabel">Surnames</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="placesCount">0</span>
                <span class="stat-label" id="placesLabel">Places</span>
            </div>
        </div>

        <div class="view-toggle">
            <button onclick="setView('cards')" id="cardsBtn" class="active">Card View</button>
            <button onclick="setView('table')" id="tableBtn">Table View</button>
        </div>

        <div class="results">
            <div class="results-header">
                <span id="resultsCount">Loading...</span>
            </div>
            <div id="resultsContainer">
                <div class="no-results" id="loadingText">Loading prosopographical data...</div>
            </div>
        </div>
    </div>

    <script>
        let prosopographicalData = [];
        let currentResults = [];
        let currentView = 'cards';
        let currentLanguage = 'en'; // 'en' or 'ka'

        // Language translations
        const translations = {
            en: {
                mainTitle: "Ṭbetis sulta maṭiane",
                subtitle: "Synodal Records from Ṭbeti - Prosopographical Database",
                msLabel: "Manuscript:",
                periodLabel: "Period:",
                periodText: "Medieval",
                languageLabel: "Language:",
                languageText: "Old Georgian",
                scriptLabel: "Script:",
                namePlaceholder: "Name",
                surnamePlaceholder: "Surname",
                placePlaceholder: "Place",
                allTypesOption: "All types",
                mainOption: "Main person",
                wifeOption: "Wife",
                sonOption: "Son",
                daughterOption: "Daughter",
                brotherOption: "Brother",
                sisterOption: "Sister",
                motherOption: "Mother",
                fatherOption: "Father",
                searchBtn: "Search",
                clearBtn: "Clear",
                showAllBtn: "Show All",
                exportBtn: "Export CSV",
                entriesLabel: "Entries",
                personsLabel: "Persons",
                surnamesLabel: "Surnames",
                placesLabel: "Places",
                cardViewBtn: "Card View",
                tableViewBtn: "Table View",
                entriesFound: "entries",
                noEntriesFound: "No entries found.",
                loading: "Loading prosopographical data...",
                entryLabel: "Entry:",
                typeLabel: "Type:",
                placeLabel: "Place:",
                msLabel2: "MS:",
                edLabel: "Ed:",
                familyTitle: "Family:",
                tableHeaders: {
                    entry: "Entry",
                    name: "Name",
                    surname: "Surname",
                    type: "Type",
                    place: "Place",
                    family: "Family",
                    msRef: "MS Ref"
                },
                langToggle: "ქართული"
            },
            ka: {
                mainTitle: "ტბეთის სულთა მატიანე",
                subtitle: "ტბეთის სინოდიკონი - პროსოპოგრაფიული მონაცემთა ბაზა",
                msLabel: "ხელნაწერი:",
                periodLabel: "პერიოდი:",
                periodText: "შუასაუკუნეები",
                languageLabel: "ენა:",
                languageText: "ძველი ქართული",
                scriptLabel: "დამწერლობა:",
                namePlaceholder: "სახელი",
                surnamePlaceholder: "გვარი",
                placePlaceholder: "ადგილი",
                allTypesOption: "ყველა ტიპი",
                mainOption: "მთავარი პირი",
                wifeOption: "მეუღლე",
                sonOption: "შვილი",
                daughterOption: "ასული",
                brotherOption: "ძმა",
                sisterOption: "და",
                motherOption: "დედა",
                fatherOption: "მამა",
                searchBtn: "ძიება",
                clearBtn: "გასუფთავება",
                showAllBtn: "ყველას ჩვენება",
                exportBtn: "CSV ექსპორტი",
                entriesLabel: "ჩანაწერები",
                personsLabel: "პირები",
                surnamesLabel: "გვარები",
                placesLabel: "ადგილები",
                cardViewBtn: "ბარათების ხედი",
                tableViewBtn: "ცხრილის ხედი",
                entriesFound: "ჩანაწერი",
                noEntriesFound: "ჩანაწერები ვერ მოიძებნა.",
                loading: "პროსოპოგრაფიული მონაცემების ჩატვირთვა...",
                entryLabel: "ჩანაწერი:",
                typeLabel: "ტიპი:",
                placeLabel: "ადგილი:",
                msLabel2: "ხნ:",
                edLabel: "გამოც:",
                familyTitle: "ოჯახი:",
                tableHeaders: {
                    entry: "ჩანაწერი",
                    name: "სახელი",
                    surname: "გვარი",
                    type: "ტიპი",
                    place: "ადგილი",
                    family: "ოჯახი",
                    msRef: "ხნ. მით."
                },
                langToggle: "English"
            }
        };

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ka' : 'en';
            updateUILanguage();
        }

        function updateUILanguage() {
            const t = translations[currentLanguage];

            // Update header
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('msLabel').textContent = t.msLabel;
            document.getElementById('periodLabel').textContent = t.periodLabel;
            document.getElementById('periodText').textContent = t.periodText;
            document.getElementById('languageLabel').textContent = t.languageLabel;
            document.getElementById('languageText').textContent = t.languageText;
            document.getElementById('scriptLabel').textContent = t.scriptLabel;

            // Update search controls
            document.getElementById('nameSearch').placeholder = t.namePlaceholder;
            document.getElementById('surnameSearch').placeholder = t.surnamePlaceholder;
            document.getElementById('placeSearch').placeholder = t.placePlaceholder;
            document.getElementById('allTypesOption').textContent = t.allTypesOption;
            document.getElementById('mainOption').textContent = t.mainOption;
            document.getElementById('wifeOption').textContent = t.wifeOption;
            document.getElementById('sonOption').textContent = t.sonOption;
            document.getElementById('daughterOption').textContent = t.daughterOption;
            document.getElementById('brotherOption').textContent = t.brotherOption;
            document.getElementById('sisterOption').textContent = t.sisterOption;
            document.getElementById('motherOption').textContent = t.motherOption;
            document.getElementById('fatherOption').textContent = t.fatherOption;
            document.getElementById('searchBtn').textContent = t.searchBtn;
            document.getElementById('clearBtn').textContent = t.clearBtn;
            document.getElementById('showAllBtn').textContent = t.showAllBtn;
            document.getElementById('exportBtn').textContent = t.exportBtn;

            // Update stats
            document.getElementById('entriesLabel').textContent = t.entriesLabel;
            document.getElementById('personsLabel').textContent = t.personsLabel;
            document.getElementById('surnamesLabel').textContent = t.surnamesLabel;
            document.getElementById('placesLabel').textContent = t.placesLabel;

            // Update view toggle
            document.getElementById('cardsBtn').textContent = t.cardViewBtn;
            document.getElementById('tableBtn').textContent = t.tableViewBtn;

            // Update language toggle button
            document.getElementById('langToggle').textContent = t.langToggle;

            // Refresh results to update labels
            displayResults();
        }

        // Parse the XML data and extract prosopographical information
        function parseXMLData() {
            const sampleData = [
                {
                    entryId: "entry_001",
                    entryNumber: 1,
                    mainPerson: {
                        name: "მახარებელი",
                        type: "evangelist",
                        role: "main",
                        place: "გორგაზიეთ"
                    },
                    familyMembers: [
                        { name: "მარიამი", type: "wife", relationship: "მეუღლესა" },
                        { name: "თამარი", type: "daughter", relationship: "ასული" }
                    ],
                    manuscript: { line: "2-4", page: "Ir" },
                    edition: { line: "2-3", page: "60" }
                },
                {
                    entryId: "entry_002",
                    entryNumber: 2,
                    mainPerson: {
                        name: "კუირიკე",
                        place: "გორგაზიეთ"
                    },
                    familyMembers: [
                        { name: "თინა", type: "wife", relationship: "მეუღლისა" },
                        { name: "ცხორება", type: "woman", relationship: "ქალისა" }
                    ],
                    manuscript: { line: "5-7", page: "Ir" },
                    edition: { line: "4-6", page: "60" }
                },
                {
                    entryId: "entry_003",
                    entryNumber: 3,
                    mainPerson: {
                        name: "იოვანე",
                        patronymic: "გულქანისშვილი"
                    },
                    familyMembers: [
                        { name: "მარიამი", type: "wife", relationship: "მეუღლისა" }
                    ],
                    manuscript: { line: "8-9", page: "Ir" },
                    edition: { line: "7-8", page: "60" }
                },
                {
                    entryId: "entry_004",
                    entryNumber: 4,
                    mainPerson: {
                        name: "გიორგი",
                        surname: "ხაპერასძე"
                    },
                    familyMembers: [
                        { name: "ნათელი", type: "wife", relationship: "მეუღლისა" }
                    ],
                    manuscript: { line: "10", page: "Ir" },
                    edition: { line: "9-10", page: "60" }
                },
                {
                    entryId: "entry_005",
                    entryNumber: 5,
                    mainPerson: {
                        name: "მიქაელი",
                        surname: "კაკალისძე"
                    },
                    familyMembers: [
                        { name: "რუსუდანი", type: "wife", relationship: "მეუღლისა" }
                    ],
                    manuscript: { line: "11-12", page: "Ir" },
                    edition: { line: "11-12", page: "60" }
                },
                {
                    entryId: "entry_006",
                    entryNumber: 6,
                    mainPerson: {
                        name: "დავითი",
                        surname: "მცხეთელი"
                    },
                    familyMembers: [
                        { name: "ანა", type: "wife", relationship: "მეუღლისა" },
                        { name: "გიორგი", type: "son", relationship: "შვილი" }
                    ],
                    manuscript: { line: "13-15", page: "Ir" },
                    edition: { line: "13-15", page: "60" }
                }
            ];

            prosopographicalData = sampleData;
            updateStatistics();
            updateUILanguage(); // Initialize with current language
            showAll();
        }

        function updateStatistics() {
            const totalEntries = prosopographicalData.length;
            const allPersons = [];
            const surnames = new Set();
            const places = new Set();

            prosopographicalData.forEach(entry => {
                allPersons.push(entry.mainPerson);
                if (entry.mainPerson.surname) surnames.add(entry.mainPerson.surname);
                if (entry.mainPerson.patronymic) surnames.add(entry.mainPerson.patronymic);
                if (entry.mainPerson.place) places.add(entry.mainPerson.place);

                if (entry.familyMembers) {
                    entry.familyMembers.forEach(member => {
                        allPersons.push(member);
                        if (member.surname) surnames.add(member.surname);
                    });
                }
            });

            document.getElementById('totalEntries').textContent = totalEntries;
            document.getElementById('totalPersons').textContent = allPersons.length;
            document.getElementById('uniqueSurnames').textContent = surnames.size;
            document.getElementById('placesCount').textContent = places.size;
        }

        function performSearch() {
            const nameSearch = document.getElementById('nameSearch').value.toLowerCase();
            const surnameSearch = document.getElementById('surnameSearch').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const placeSearch = document.getElementById('placeSearch').value.toLowerCase();

            currentResults = prosopographicalData.filter(entry => {
                const mainMatch = matchesPerson(entry.mainPerson, nameSearch, surnameSearch, typeFilter, placeSearch);
                const familyMatch = entry.familyMembers && entry.familyMembers.some(member =>
                    matchesPerson(member, nameSearch, surnameSearch, typeFilter, placeSearch)
                );
                return mainMatch || familyMatch;
            });

            displayResults();
        }

        function matchesPerson(person, nameSearch, surnameSearch, typeFilter, placeSearch) {
            const nameMatch = !nameSearch || person.name?.toLowerCase().includes(nameSearch);
            const surnameMatch = !surnameSearch ||
                person.surname?.toLowerCase().includes(surnameSearch) ||
                person.patronymic?.toLowerCase().includes(surnameSearch);
            const typeMatch = !typeFilter || person.type === typeFilter;
            const placeMatch = !placeSearch || person.place?.toLowerCase().includes(placeSearch);

            return nameMatch && surnameMatch && typeMatch && placeMatch;
        }

        function clearSearch() {
            document.getElementById('nameSearch').value = '';
            document.getElementById('surnameSearch').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('placeSearch').value = '';
            showAll();
        }

        function showAll() {
            currentResults = prosopographicalData;
            displayResults();
        }

        function setView(view) {
            currentView = view;
            document.getElementById('cardsBtn').classList.toggle('active', view === 'cards');
            document.getElementById('tableBtn').classList.toggle('active', view === 'table');
            displayResults();
        }

        function displayResults() {
            const container = document.getElementById('resultsContainer');
            const countElement = document.getElementById('resultsCount');
            const t = translations[currentLanguage];

            countElement.textContent = `${currentResults.length} ${t.entriesFound}`;

            if (currentResults.length === 0) {
                container.innerHTML = `<div class="no-results">${t.noEntriesFound}</div>`;
                return;
            }

            if (currentView === 'table') {
                displayTableView(container);
            } else {
                displayCardView(container);
            }
        }

        function displayCardView(container) {
            const html = currentResults.map(entry => createPersonCard(entry)).join('');
            container.innerHTML = html;
        }

        function displayTableView(container) {
            const t = translations[currentLanguage];
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>${t.tableHeaders.entry}</th>
                            <th>${t.tableHeaders.name}</th>
                            <th>${t.tableHeaders.surname}</th>
                            <th>${t.tableHeaders.type}</th>
                            <th>${t.tableHeaders.place}</th>
                            <th>${t.tableHeaders.family}</th>
                            <th>${t.tableHeaders.msRef}</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            currentResults.forEach(entry => {
                const familyNames = entry.familyMembers ?
                    entry.familyMembers.map(m => `${m.name} (${getLocalizedType(m.type)})`).join(', ') : '';

                html += `
                    <tr>
                        <td>${entry.entryNumber}</td>
                        <td class="georgian-text">${entry.mainPerson.name}</td>
                        <td class="georgian-text">${entry.mainPerson.surname || entry.mainPerson.patronymic || ''}</td>
                        <td>${getLocalizedType(entry.mainPerson.type) || ''}</td>
                        <td class="georgian-text">${entry.mainPerson.place || ''}</td>
                        <td class="georgian-text">${familyNames}</td>
                        <td>f. ${entry.manuscript.page}, l. ${entry.manuscript.line}</td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function getLocalizedType(type) {
            const typeMap = {
                'main': { en: 'main', ka: 'მთავარი' },
                'wife': { en: 'wife', ka: 'მეუღლე' },
                'son': { en: 'son', ka: 'შვილი' },
                'daughter': { en: 'daughter', ka: 'ასული' },
                'brother': { en: 'brother', ka: 'ძმა' },
                'sister': { en: 'sister', ka: 'და' },
                'mother': { en: 'mother', ka: 'დედა' },
                'father': { en: 'father', ka: 'მამა' },
                'evangelist': { en: 'evangelist', ka: 'მახარებელი' },
                'woman': { en: 'woman', ka: 'ქალი' }
            };

            return typeMap[type] ? typeMap[type][currentLanguage] : type;
        }

        function createPersonCard(entry) {
            const mainPerson = entry.mainPerson;
            const familyMembers = entry.familyMembers || [];
            const t = translations[currentLanguage];

            return `
                <div class="person-card">
                    <div class="person-name georgian-text">
                        ${mainPerson.name}
                        ${mainPerson.surname ? ` (${mainPerson.surname})` : ''}
                        ${mainPerson.patronymic ? ` (${mainPerson.patronymic})` : ''}
                    </div>
                    <div class="person-details">
                        <div class="detail-item">
                            <span class="detail-label">${t.entryLabel}</span>
                            <span>${entry.entryNumber}</span>
                        </div>
                        ${mainPerson.type ? `
                        <div class="detail-item">
                            <span class="detail-label">${t.typeLabel}</span>
                            <span>${getLocalizedType(mainPerson.type)}</span>
                        </div>
                        ` : ''}
                        ${mainPerson.place ? `
                        <div class="detail-item">
                            <span class="detail-label">${t.placeLabel}</span>
                            <span class="georgian-text">${mainPerson.place}</span>
                        </div>
                        ` : ''}
                        <div class="detail-item">
                            <span class="detail-label">${t.msLabel2}</span>
                            <span>f. ${entry.manuscript.page}, l. ${entry.manuscript.line}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">${t.edLabel}</span>
                            <span>p. ${entry.edition.page}, l. ${entry.edition.line}</span>
                        </div>
                    </div>
                    ${familyMembers.length > 0 ? `
                    <div class="family-members">
                        <div class="family-title">${t.familyTitle}</div>
                        ${familyMembers.map(member => `
                            <span class="family-member georgian-text">
                                ${member.name} (${getLocalizedType(member.type)})
                            </span>
                        `).join('')}
                    </div>
                    ` : ''}
                </div>
            `;
        }

        function exportData() {
            const csvContent = "data:text/csv;charset=utf-8," +
                "Entry,Name,Surname,Type,Place,Family_Members\n" +
                currentResults.map(entry => {
                    const familyNames = entry.familyMembers ?
                        entry.familyMembers.map(m => `${m.name}(${m.type})`).join(';') : '';
                    return `${entry.entryNumber},"${entry.mainPerson.name}","${entry.mainPerson.surname || entry.mainPerson.patronymic || ''}","${entry.mainPerson.type || ''}","${entry.mainPerson.place || ''}","${familyNames}"`;
                }).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "tbeti_prosopographical_data.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Set initial loading text
            const t = translations[currentLanguage];
            document.getElementById('loadingText').textContent = t.loading;

            parseXMLData();

            document.getElementById('nameSearch').addEventListener('input', performSearch);
            document.getElementById('surnameSearch').addEventListener('input', performSearch);
            document.getElementById('typeFilter').addEventListener('change', performSearch);
            document.getElementById('placeSearch').addEventListener('input', performSearch);
        });
    </script>
</body>
</html>
